#!/bin/sh

ps() {
	if [ -z "$name" ]; then
		docker ps
	elif [ -z "$id" ]; then
		echo "$name stopped"
	else
		echo "$name running"
	fi
}

start() {
	if [ -z "$name" ]; then
		for f in $folder/*.yaml
		do
			name=$(basename "$f" .yaml)
			docker compose -f "$f" -p "$name" up -d
		done
	else
		docker compose -f "$folder/$name.yaml" -p "$name" up -d
	fi
}

stop() {
	if [ -z "$name" ]; then
		for f in $folder/*.yaml
		do
			name=$(basename "$f" .yaml)
			docker compose -f "$f" -p "$name" stop
		done
	else
		docker compose -f "$folder/$name.yaml" -p "$name" stop
	fi
}

help() {
	echo "Usage:"
	echo "  dockers [COMMAND] [NAME]"
	echo ""
	echo "Commands:"
	echo "  ps           list container(s)"
	echo "  start        start container(s)"
	echo "  stop         stop container(s)"
	echo ""
	echo "All containers will be applied if NAME is omitted."
}

folder="$HOME/.config/dockers"
name=$2
id=$(docker ps -qf "name=$name")

case "$1" in
	ps|start|stop ) $1 ;;
	*             ) help ;;
esac
