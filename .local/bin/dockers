#!/bin/sh

ps() {
	if [ -n "$name" ]; then
		docker ps -aq --filter "name=$1" > /dev/null && echo "$1 running" || echo "$1 stopped"
	else
		docker ps
	fi
}

start() {
	sudo systemctl start docker.service
	if [ -n "$name" ]; then
		docker compose -f "$folder/$1.yaml" up -d
	else
		for f in $folder/*.yaml
		do
			docker compose -f "$f" up -d
		done
	fi
}

stop() {
	if [ -n "$name" ]; then
		docker compose -f "$folder/$1.yaml" stop
	else
		for f in $folder/*.yaml
		do
			docker compose -f "$f" stop
		done
	fi
	sudo systemctl stop docker.socket
	sudo systemctl stop docker.service
}

help() {
	echo "Usage: dockers [start|stop|status]"
}

folder="$HOME/.config/dockers"
name=$2
case "$1" in
	ps|start|stop ) $1 ;;
	*             ) help ;;
esac
