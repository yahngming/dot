#!/bin/sh

off() {
	if [ -n "$WAYLAND_DISPLAY" ]; then
		pgrep hypridle || hypridle &
	elif [ -n "$DISPLAY" ]; then
		xautolock -enable
		xset +dpms
	fi
	notify-send "Caffeine OFF"
}

on() {
	if [ -n "$WAYLAND_DISPLAY" ]; then
		pkill hypridle
	elif [ -n "$DISPLAY" ]; then
		xautolock -disable
		xset -dpms
	fi
	notify-send "Caffeine ON"
}

help() {
	if pgrep hypridle || [ "$(xset q | grep '^\s*DPMS is' | awk '{print $3}')" == "Enabled" ]; then
		mode="DISABLED"
	else
		mode="ENABLED"
	fi
	echo "Idle inhibit $mode"
	echo ""
	echo "Usage: caffeine [MODE]"
	echo "  off        disable idle inhibit"
	echo "  on         enable idle inhibit"
}

mode=${1:-help}
$mode
