#!/bin/sh

off() {
	if [ -n "$WAYLAND_DISPLAY" ]; then
		pgrep hypridle || hypridle &
	elif [ -n "$DISPLAY" ]; then
		xautolock -enable
		xset +dpms
	fi
}

on() {
	if [ -n "$WAYLAND_DISPLAY" ]; then
		pkill hypridle
	elif [ -n "$DISPLAY" ]; then
		xautolock -disable
		xset -dpms
	fi
}

help() {
	echo "Usage: caffeine [off|on]"
}

status() {
	if pgrep hypridle >/dev/null || [ "$(xset q | grep '^\s*DPMS is' | awk '{print $3}')" == "Enabled" ]; then
		mode="DISABLED"
	else
		mode="ENABLED"
	fi
	echo "Idle inhibit $mode"
}

case "$@" in
	help|off|on ) $@ ;;
	*           ) status ;;
esac
