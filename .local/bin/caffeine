#!/bin/sh

off() {
	if [ -n "$WAYLAND_DISPLAY" ]; then
		pgrep swayidle || swayidle -w &
	elif [ -n "$DISPLAY" ]; then
		xautolock -enable
		xset +dpms
	fi
}

on() {
	if [ -n "$WAYLAND_DISPLAY" ]; then
		pkill swayidle
	elif [ -n "$DISPLAY" ]; then
		xautolock -disable
		xset -dpms
	fi
}

status() {
	if pgrep swayidle >/dev/null || [ "$(xset q | grep '^\s*DPMS is' | awk '{print $3}')" == "Enabled" ]; then
		echo "Presentation OFF"
	else
		echo "Presentation ON"
	fi
}

help() {
	echo "Usage: caffeine [off|on]"
}

case "$@" in
	help|off|on ) $@ ;;
	*           ) status ;;
esac
