#!/bin/sh

off() {
	if [ -n "$WAYLAND_DISPLAY" ]; then
		idler
	elif [ -n "$DISPLAY" ]; then
		$IDLER -enable
		xset +dpms
	fi
}

on() {
	if [ -n "$WAYLAND_DISPLAY" ]; then
		pkill $IDLER
	elif [ -n "$DISPLAY" ]; then
		$IDLER -disable
		xset -dpms
	fi
}

status() {
	if pgrep $IDLER >/dev/null || [ "$(xset q | grep '^\s*DPMS is' | awk '{print $3}')" == "Enabled" ]; then
		echo "Presentation OFF"
	else
		echo "Presentation ON"
	fi
}

help() {
	echo "Usage: caffeine [off|on]"
}

case "$@" in
	help|off|on ) $@ ;;
	*           ) status ;;
esac
