#!/bin/sh

screensavers=(
	"asciiquarium -s -t"
	"neo-matrix -s"
	"lavat -g -c FF0000 -k FF00FF"
	"ttesvr"
	"ttysvr"
)

if pgrep -f "-c screensaver" || pgrep locker; then
	exit
elif [ -f ~/.config/screendim ]; then
	brightnessctl -s set 10
elif [ -f ~/.config/screenoff ]; then
	if [ -n "$WAYLAND_DISPLAY" ]; then
		hyprctl dispatch dpms off
	fi
elif [ -f ~/.config/screensaver ] || [ "$@" == "preview" ]; then
	while true; do
		screensaver=${screensavers[$(($RANDOM%${#screensavers[@]}))]}
		read -r -a command <<< "$screensaver"
		if command -v "${command[0]}"; then
			st -F -c screensaver -e $SHELL -c "$screensaver"
			exit
		fi
	done
fi
